<apex:page id="QuickRegistration"  showHeader="false" controller="BLN_Quick_Registration_Con" standardStylesheets="false" action="{!displayPermissions}">

  <!------------common styles component------------>
    <c:ed_commonstyles ></c:ed_commonstyles>
    <!------------//common styles component---------->
   <c:ValidationsCommon ></c:ValidationsCommon>
  <head><title>Eventdex</title></head>

   <title>Eventdex-Orders</title>
    <!-- --------------------------- Basic Style sheets ---------------------------------- -->
    
    <!-- <apex:stylesheet value="{!URLFOR($Resource.MyTickets, 'css/style.css')}"/>
     <apex:stylesheet value="{!URLFOR($Resource.MyTickets, 'style-button.css')}"/>-->
      <!--<script type="text/javascript" src="{!URLFOR($Resource.MyTickets, 'js/jquery.min.js')}"></script>-->
      <script type="text/javascript" src="{!$Resource.jquery11}"></script>
       <script type="text/javascript" src="{!URLFOR($Resource.MyTickets, 'js/zebra_accordion.src -att.js')}"></script>
      <script type="text/javascript" src="{!URLFOR($Resource.MyTickets, 'js/jquery-ui-1.8.16.custom.min.js')}"></script>
  <!--    <script type="text/javascript" src="{!URLFOR($Resource.MyTickets, 'js/functions.js')}"></script>-->
      <apex:includeScript value="{!$Resource.PhoneSetup}"/>
<c:ed_popupbox ></c:ed_popupbox>
    <style type="text/css">
input.styled {
    display: none;
}
select.styled {
    position: relative;
    width: 190px;
    opacity: 0;
    filter: alpha(opacity=0);
    z-index: 5;
}
.disabled {
    opacity: 0.5;
    filter: alpha(opacity=50);
}
#formfield tr td {
    padding: 5px;
}
#formfield input[type="text"] {
    width: 100%;
    box-shadow: #F4F4F4 1px 4px 10px 0px;
    background: none;
    background-color: #FCFCFC;
    font-weight:bold;
    color: #000;
    border: 1px solid #e3e3e3;
    text-indent: 5px;
    padding-left: 2px;
    height: 40px;
    border-radius: 3px;
    padding: 0px;
    margin: 0px;
    outline: none;
}
#formfield select {
    width: 210%;
    box-shadow: #F4F4F4 1px 4px 10px 0px;
    background: none;
    background-color: #FCFCFC;
    font-weight:bold;
    color: #000;
    border: 1px solid #e3e3e3;
    text-indent: 5px;
    padding-left: 2px;
    height: 40px;
    border-radius: 3px;
    padding: 0px;
    margin: 0px;
    outline: none;
}
#formfield input[type="email"] {
    width: 100%;
    box-shadow: #F4F4F4 1px 4px 10px 0px;
    background: none;
    background-color: #FCFCFC;
    font-weight:bold;
    color: #000;
    border: 1px solid #e3e3e3;
    text-indent: 5px;
    padding-left: 2px;
    height: 40px;
    border-radius: 3px;
    padding: 0px;
    margin: 0px;
    outline: none;
}
#formfield input[type="checkbox"] {
    outline: none;
    border: none;
}
.printbadge {
width: 100%;
height: 40px;
border:1px solid #b7b7b7;
-webkit-border-radius: 3px;
cursor: pointer;
-moz-border-radius: 3px;
border-radius: 3px;
font-size: 18px;
font-family: cuprum;
padding: 10px 10px 10px 10px;
text-decoration: none;
display: inline-block;
color: #FFFFFF;
font-weight: bold;
background-color: #d3d3d3; background-image: -webkit-gradient(linear, left top, left bottom, from(#d3d3d3), to(#707070));
background-image: -webkit-linear-gradient(top, #d3d3d3, #707070);
background-image: -moz-linear-gradient(top, #d3d3d3, #707070);
background-image: -ms-linear-gradient(top, #d3d3d3, #707070);
background-image: -o-linear-gradient(top, #d3d3d3, #707070);
background-image: linear-gradient(to bottom, #d3d3d3, #707070);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#d3d3d3, endColorstr=#707070);
}
.printbadge:hover {
border:1px solid #a0a0a0;
background-color: #bababa; background-image: -webkit-gradient(linear, left top, left bottom, from(#bababa), to(#575757));
background-image: -webkit-linear-gradient(top, #bababa, #575757);
background-image: -moz-linear-gradient(top, #bababa, #575757);
background-image: -ms-linear-gradient(top, #bababa, #575757);
background-image: -o-linear-gradient(top, #bababa, #575757);
background-image: linear-gradient(to bottom, #bababa, #575757);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#bababa, endColorstr=#575757);
}

.new-page{
  page-break-before: always;
}
</style>
<!-- -------------------------------------------------------- apex end------------------------------------------ -->
 <c:myComponent BLN_UtillDisplayLinks="{!myticket}" id="compo" >
 <style>
 #tabs-container{
 overflow: hidden;
margin: 0px;
margin-top:-10px;
margin-left:-.7%;
padding: 0px;
clear: none;
width: 103%;


 background: #fefefe;
background: -moz-linear-gradient(top,#fefefe 0,#f3f3f3 100%);
background: -webkit-gradient(linear,left top,left bottom,color-stop(0%,#fefefe),color-stop(100%,#f3f3f3));
background: -webkit-linear-gradient(top,#fefefe 0,#f3f3f3 100%);
background: -o-linear-gradient(top,#fefefe 0,#f3f3f3 100%);
background: -ms-linear-gradient(top,#fefefe 0,#f3f3f3 100%);
background: linear-gradient(top,#fefefe 0,#f3f3f3 100%);
 }
 
 .tabs-menu {
 list-style: none;
    margin: 0px;
padding: 0px;
font-size: 13px;
outline: none;
}

.tabs-menu li {
 position: relative;
/* top: 1px; */
float: left;
padding: 4px 10px;
margin: 0px 1px 0px 0px;

/* background-color: #DDD; */
list-style: none;
border-right: 1px solid #ddd;
border-bottom: 1px solid #ddd;
-moz-user-select: none;
-khtml-user-select: none;
cursor: pointer;
padding: 11px 20px 9px 20px;
}


.tabs-menu li.current {
   
    background-color: #ffffff;
border-bottom: 1px solid #fff;
/* height: 14.4px; */
-moz-box-shadow: inset 0 2px #2a90d3;
-webkit-box-shadow: inset 0 2px #2a90d3;
box-shadow: inset 0 2px #2a90d3;

}


.tabs-menu li:hover { background: -webkit-linear-gradient(top,#fcfcfc 0,#dedede 100%);
background: #fcfcfc;
background: -moz-linear-gradient(top,#fcfcfc 0,#dedede 100%);
background: -webkit-gradient(linear,left top,left bottom,color-stop(0%,#fcfcfc),color-stop(100%,#dedede));}


.tabs-menu li a {
    outline: none;
focus: none;
color: #555;
font-weight: 300;
text-decoration:none;
}


.tabs-menu .current a {
    outline: none;
focus: none;
color: #555;
font-weight: 300;
}

.tab {
    border: 1px solid #d4d4d1;
    background-color: #fff;
    float: left;
    margin-bottom: 20px;
    width: auto;
}


.tab-content {
    width: 660px;
    padding: 20px;
    display: none;
}

#tab-1 {
 display: block;   
}
 </style>
 
 
 <!------new code------->
    <script>
    var resourcePath='{!URLFOR($Resource.badgeToolRenderAssets)}';
    </script>
<script src="{!URLFOR($Resource.badgeToolRenderAssets, '/scripts/lib/jquery-2.1.4.min.js')}"></script>
<script>

function test(selectedbadge){
//alert(selectedbadge);
renderBadge(selectedbadge);
} 
function renderBadge(badgeid,print){
 var canvaswidth='';
  var canvasheight='';
var selectedbadgeid=badgeid;
    Visualforce.remoting.Manager.invokeAction(
    'BLN_Quick_Registration_Con.getRenderData','{!selectedEvent}',
    selectedbadgeid,
    function(result, event) {
        $('#ifrmeSummary').empty();
       // var attendees = JSON.parse(result.attendeeData).attendees;
        var  styleData = JSON.parse(result.style.badge.Data__c);
        //var pages = Math.ceil(attendees.length / result.layoutData.perPage);
        console.log(result);
     if(result.layoutData.pageWidth !=8.5 && result.layoutData.pageHeight!=11){
        canvaswidth  = result.layoutData.pageWidth;
        canvasheight  = result.layoutData.pageHeight;
       }
       else if(result.layoutData.pageWidth ==8.5 && result.layoutData.pageHeight==11){
        canvaswidth  = 4;
        canvasheight  = 3;
       }
        $("#ifrmeSummary")
            .css({
                width: canvaswidth+"in",
                height: canvasheight+"in"
            });
              
        for (var pageNum = 0; pageNum < 1; pageNum++) {
            
            for (var rowNum = 0; rowNum < 1; rowNum++) {
              //  var badgesInRow =attendees.slice(pageNum * result.layoutData.perPage + rowNum * result.layoutData.perRow,
              //                      pageNum * result.layoutData.perPage + rowNum * result.layoutData.perRow + result.layoutData.perRow);
        
                for (var i = 0; i < 1; i++) {
                    var positionDataForBadge = {
                        width: styleData.canvasWidth+"in",
                        height: styleData.canvasHeight+"in",
                           
                        backgroundColor: styleData.backgroundColor,
                        backgroundImage: "url("+styleData.backgroundImage+")",
                        backgroundRepeat: styleData.backgroundRepeat,
                        backgroundSize: styleData.backgroundSize,
                        backgroundPosition: styleData.backgroundPosition
                    };
                    
                    var badge = $("<div class='badge' />")
                        .css(positionDataForBadge)
                        .appendTo("#ifrmeSummary");
                    
                    addLayersTo(badge, result.style.layers, styleData, 1);
                }
            }
        
        }
         update();
         if(print=='true')
         {
           var abarcode=$('#badgeqrid').val();
         //  alert(abarcode);
 if(abarcode !='' && abarcode !=null && abarcode !=undefined)
 {
         $('.barcode').css("backgroundImage", "url(https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl="+abarcode+")");
 
}
 var printdata  =document.getElementById("ifrmeSummary").innerHTML;
 
     
printdata = '<style>@page{size:'+canvaswidth+'in '+canvasheight+'in;}</style>'+printdata;

document.body.innerHTML = printdata;
             
               //Restore orignal HTML
           
       setTimeout(function(){window.location.href=window.location.href;}, 4000);
           
            //Print Page
 setTimeout(function(){
  window.print();
 }, 2000);
            
     
 
         }
    },
    { escape: false });
    }


function addLayersTo(badge, layers, styleData, attendee) {
//console.log(attendee);
    for (var i = 0, j = layers.length; i < j; i++) {
        var layerData = JSON.parse(layers[i].Data__c);
     // console.log(layerData);
        layerData.id = undefined;
        layerData.formatOptions = undefined;
        layerData.elem = undefined;
        layerData.scope = undefined;
        layerData.canvas = undefined;
        
        var layer = $("<div class='layer' />");
        
        for (var prop in layerData) {
            switch (prop) {
                case "id":
                case "formatOptions":
                case "elem":
                case "scope":
                case "canvas":
                case "directive":
                case "selected":
                    continue;
                    break;
                
                case "width":
                    layer.css("width", layerData[prop] * styleData.canvasWidth + "in");
                    break;
                case "height":
                    layer.css("height", layerData[prop] * styleData.canvasWidth + "in");
                    break;
                
                case "x":
                    layer.css("left", layerData[prop] * styleData.canvasWidth + "in");
                    break;
                case "y":
                    layer.css("top", layerData[prop] * styleData.canvasWidth + "in");
                    break;
                
                case "color":
                    if (layerData.layerType == "SHAPE") {
                        layer.css("backgroundColor", layerData[prop]);
                    } else {
                        layer.css("color", layerData[prop]);
                    }
                    break;
                
                case "shape":
                    if (layerData[prop] == 1) {
                        layer.css("borderRadius", "50%");
                    }
                    break;
                
                case "content":
                    if(layerData.layerType=="BAR_CODE"){
                    if(layerData.content=="Bar-Code"){
                  layer.css("backgroundImage", "url(https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=thisisabummyqr)");
                   layer.addClass('barcode');  
                  
                     }else{
                 layer.css("backgroundImage", "url(https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=thisisabummyqr)");
                     layer.addClass('barcode');  
                  
                  }
                    }
                    
                   else if(layerData.layerType=="QR_CODE"){
                    if(layerData.content=="Bar-Code"){
                       layer.css("backgroundImage", "url(https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=thisisabummyqr)");
                   layer.addClass('barcode');  
                  
                     }else{
                 layer.css("backgroundImage", "url(https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=thisisabummyqr)");
                     layer.addClass('barcode');  
                  
                  }
                    }
                    else if (layerData.layerType == "TEXT") {
                        $("<span class='text' />").text(layerData[prop]).appendTo(layer);
                    } else if (layerData.layerType == "ATTENDEE_DATA") {
                        var contents = {
                        
                            
                            
                            "John Smith": "John Smith",
                            "John":"John" ,
                            "Smith":"Smith",
                            "My Company": "My Company",
                            "President": "President",
                            "Attendee":"Attendee",
                            "Label":"Label",
                            "Printed":"Printed",
                            "012":"012",
                            "Fully Paid":"Fully Paid",
                            "Buyer Name":"Buyer Name",
                            "O-00062251":"O-00062251",
                            "TKT-1265433":"TKT-1265433",
                            "0723":"0723"
                          
                        };
                        
                        var contentids = {
                        
                            
                            
                            "John Smith": "fullname",
                            "John":"firstname" ,
                            "Smith":"lastname",
                            "My Company": "company",
                            "President": "designation",
                            "Attendee":"badgelabel",
                            
                        };
                        $("<span class='text' id="+contentids[layerData[prop]]+" />").text(contents[layerData[prop]]).appendTo(layer);
                    }
                    break;
                
                case "transform":
                    layer.css("textTransform", layerData[prop]);
                    break;
                
                case "image":
            //new logic to display blank image with event logo
                var im = layerData[prop];
                if(im.indexOf('servlet') != -1){
                    layer.css("backgroundImage", "url("+layerData[prop]+")");
                    }
                    else if(im.indexOf('servlet') == -1)
                    {
                    
                    }
                    break;
                
                case "rotation":
                    // do later
                    break;
                
                case "align":
                    layer.css("textAlign", layerData[prop]);
                    break;
                
                default:
                    layer.css(prop, layerData[prop]);
            }
        }
        if (layerData.rotation) {
            layer.find(".text").css("transform", "rotate("+layerData.rotation+"deg)");
        }
        
        badge.append(layer);
        
        if (layerData.layerType == "TEXT" || layerData.layerType == "ATTENDEE_DATA") {
            var textElem = layer.find(".text");
            
            var getTextWidth = function() {
                var spanText = $("body #spanCalculateTextWidth");
                if (spanText.size() <= 0) {
                  spanText = $("<span id='spanCalculateTextWidth' style='filter: alpha(0);'></span>");
                  spanText.appendTo("body");
                }
                var valu = layer.val();
                if (!valu) valu = layer.text();
                spanText.text(valu);
                spanText.css({
                  "fontSize": textElem.css('fontSize'),
                  "fontWeight": layer.css('fontWeight'),
                  "fontFamily": layer.css('fontFamily'),
                  "textTransform": layer.css('textTransform'),
                  "position": "absolute",
                  "top": 0,
                  "opacity": 0,
                  "left": -2000
                });
                return spanText.outerWidth() + parseInt(layer.css('paddingLeft')) + 'px';
            };
                
            var getTextHeight = function() {
                var spanText = $("body #spanCalculateTextWidth");
                if (spanText.size() <= 0) {
                  spanText = $("<span id='spanCalculateTextWidth' style='filter: alpha(0);'></span>");
                  spanText.appendTo("body");
                }
                var valu = layer.val();
                if (!valu) valu = layer.text();
                spanText.text(valu);
                spanText.css({
                  "fontSize": textElem.css('fontSize'),
                  "fontWeight": layer.css('fontWeight'),
                  "fontFamily": layer.css('fontFamily'),
                  "textTransform": layer.css('textTransform'),
                  "position": 'absolute',
                  "top": 0,
                  "opacity": 0,
                  "left": -2000,
                  "lineHeight": 1
                });
                return spanText.innerHeight() + 'px';
            };
            
            var autoTextSize = function(minSize, maxSize) {
                var _self = layer,
                    _text = layer.find(".text"),
                    _width = layer.width(),
                    _height = layer.height(),
                    _textWidthUnrotated = parseInt(getTextWidth()),
                    _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated)),
                    _fontSize = parseInt(_text.css('font-size'));
                
                var rot = _text.css("transform");
                if (rot == "none" || !rot) {
                    var _rotation = 0;
                } else {
                    var rotValues = rot.split('(')[1].split(')')[0].split(',');
                    var rotA = rotValues[0];
                    var rotB = rotValues[1];
                    var rotC = rotValues[2];
                    var rotD = rotValues[3];
                    var _rotation = Math.atan2(rotB, rotA);
                }
                
                if (_rotation < 0) {
                    _rotation += Math.PI * 2;
                }
                
                var _rotationDeg = _rotation * 180 / Math.PI;
                if (_rotationDeg > 90 && _rotationDeg <= 180) {
                    _rotationDeg = 180 - _rotationDeg;
                    _rotation = _rotationDeg * Math.PI / 180;
                } else if (_rotationDeg > 180 && _rotationDeg <= 270) {
                    _rotationDeg = _rotationDeg - 180;
                    _rotation = _rotationDeg * Math.PI / 180;
                } else if (_rotationDeg > 270 && _rotationDeg <= 360) {
                    _rotationDeg = 360 - _rotationDeg;
                    _rotation = _rotationDeg * Math.PI / 180;
                }
                
                var trig1 = Math.cos(_rotation),
                    trig2 = Math.cos((Math.PI/2)-_rotation),
                    trig3 = Math.sin(_rotation),
                    trig4 = Math.sin((Math.PI/2)-_rotation);
                
                var _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                var _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                
                if (!_textWidth) return false;
                
                if ( (_rotationDeg >= 0 && _rotationDeg <= 45) ) {
                    if (_width > _textWidth) {
                        while (_width > _textWidth) {
                            _fontSize++;
                            _text.css('font-size', _fontSize + 'px');
                            
                            _textWidthUnrotated = parseInt(getTextWidth());
                            _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                            _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                            _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                        }
                        _fontSize--;
                        _text.css('font-size', _fontSize + 'px');
                        _textWidthUnrotated = parseInt(getTextWidth());
                        _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                        _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                        _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                    } else {
                        while (_width < _textWidth || (maxSize && _fontSize > parseInt(maxSize))) {
                            if (minSize && _fontSize <= parseInt(minSize)) break;
                            
                            _fontSize--;
                            _text.css('font-size', _fontSize + 'px');
                            
                            _textWidthUnrotated = parseInt(getTextWidth());
                            _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                            _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                            _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                        }
                    }
                
                    while (_textHeight > _height) {
                        _fontSize--;
                        _text.css('font-size', _fontSize + 'px');
                        
                        _textWidthUnrotated = parseInt(getTextWidth());
                        _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                        _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                        _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                    }
                } else {
                    if (_height > _textHeight) {
                        while (_height > _textHeight) {
                            _fontSize++;
                            _text.css('font-size', _fontSize + 'px');
                            
                            _textWidthUnrotated = parseInt(getTextWidth());
                            _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                            _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                            _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                        }
                        _fontSize--;
                        _text.css('font-size', _fontSize + 'px');
                        _textWidthUnrotated = parseInt(getTextWidth());
                        _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                        _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                        _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                    } else {
                        while (_height < _textHeight || (maxSize && _fontSize > parseInt(maxSize))) {
                            if (minSize && _fontSize <= parseInt(minSize)) break;
                            
                            _fontSize--;
                            _text.css('font-size', _fontSize + 'px');
                            
                            _textWidthUnrotated = parseInt(getTextWidth());
                            _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                            _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                            _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                        }
                    }
                
                    while (_textWidth > _width) {
                        _fontSize--;
                        _text.css('font-size', _fontSize + 'px');
                        
                        _textWidthUnrotated = parseInt(getTextWidth());
                        _textHeightUnrotated = parseInt(getTextHeight(_textWidthUnrotated));
                        _textWidth = _textWidthUnrotated * trig1 + _textHeightUnrotated * trig2;
                        _textHeight = _textWidthUnrotated * trig3 + _textHeightUnrotated * trig4;
                    }
                }
                
                _text.css('line-height', _width * trig3 + _height * trig4 + "px");
                _text.css('top', '50%');
                _text.css('marginTop', (_width * trig3 + _height * trig4)/2*-1 + "px");
                
                var align = _text.parent().css('text-align');
                if (!align || align == "left" || align == "start") {
                    _text.css('left', 0);
                    _text.css('marginLeft', _textWidthUnrotated/2*-1 + _textWidth/2);
                    _text.css('right', 'auto');
                    _text.css('marginRight', 0);
                } else if (align == "center") {
                    _text.css('left', '50%');
                    _text.css('marginLeft', _textWidthUnrotated/2*-1);
                    _text.css('right', 'auto');
                    _text.css('marginRight', 0);
                } else if (align == "right") {
                    _text.css('right', '0');
                    _text.css('left', 'auto');
                    _text.css('marginLeft', 0);
                    _text.css('marginRight', _textWidthUnrotated/2*-1 + _textWidth/2);
                }
                
                textWidth = _textWidth;
                textWidthUnrotated = _textWidthUnrotated;
            }
            
            autoTextSize();
        }
    }
}

</script>

<apex:stylesheet value="{!URLFOR($Resource.badgeToolRenderAssets, 'styles/build/main.css')}" />
<body>
<script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Droid+Serif:400,700,400italic,700italic:latin', 'Raleway:400,700:latin' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })(); </script>
</body>
    
    <!-----new code end ------>
 
 
 <input type='hidden' id='badgeqrid'/>
<div id="tabs-container">
    <ul class="tabs-menu">
       
        <a href="{!$Site.BaseUrl}/apex/BLN_QUICKREGISTRATION?id={!$CurrentPage.parameters.id}&tab=attendee"><li id="attendee" class="current">Self Service Quick Registration</li></a>
        <a href="{!$Site.BaseUrl}/apex/BLN_QUICKREGISTRATION?id={!$CurrentPage.parameters.id}&tab=staffwithpayment"><li id="staffwithpayment">Staff Quick Registration With Payments</li></a>
        
    </ul>
</div>
<script>
var nobadgelabel='';
var freeticket='';
$(document).ready(function() {
    try{
    $('#{!$CurrentPage.parameters.tab}').addClass("current");
        $('#{!$CurrentPage.parameters.tab}').parent().siblings().children().removeClass("current");
        }catch(e){}
        
      
});
</script><br/><br/>
                <div class="grid-1" style=" width:97%;margin-top:10px; margin-left:.8%"  > 
 <c:AjaxLoader LoaderImage="{!$Resource.AjaxLoaderImage}"/>                   
             <!-- ----------------------------------------Your Topbox------------------------------------------------ --> 
       <apex:form id="QuickRegistrationForm">  
       <apex:outputpanel layout="none" rendered="{!if($CurrentPage.parameters.tab=='attendee'||$CurrentPage.parameters.tab=='',true,false)}">
      IFrame Link: <input type="text" readonly="readonly" style="width:90%; box-shadow: #F4F4F4 1px 4px 10px 0px; background:none; background-color: #FCFCFC; color:#999;border: 1px solid #e3e3e3;  text-indent:5px; padding-left:2px; height:15px; border-radius:3px; padding:0px; margin:0px; outline:none;" value="{!$Site.BaseUrl}/apex/BLN_QuickRegistrationIframe?id={!$CurrentPage.parameters.id}&tab=attendee"/>
      </apex:outputpanel>
      <apex:outputpanel layout="none" rendered="{!if($CurrentPage.parameters.tab=='staffwithpayment',true,false)}">
      IFrame Link: <input type="text" style="width:90%; box-shadow: #F4F4F4 1px 4px 10px 0px; background:none; background-color: #FCFCFC; color:#999;border: 1px solid #e3e3e3;  text-indent:5px; padding-left:2px; height:15px; border-radius:3px; padding:0px; margin:0px; outline:none;" value="{!$Site.BaseUrl}/apex/BLN_QuickRegistrationIframe?id={!$CurrentPage.parameters.id}&tab=staffwithpayment"/>
      </apex:outputpanel>
      <div id='badgesection' style="width:95%; height:auto; margin:0px auto; border:0px solid #ccc; padding:5px; margin-top:10px; padding-bottom:5px; border-radius:3px;   background-color:#F5F5F5;  box-shadow: #999 1px 3px 10px 0px; ">
       <apex:outputPanel id="bpop">
       Select Badge:      <apex:selectList value="{!selectedbdtemname}" multiselect="false" size="1"  styleClass="selectlist targetdiv" style=" display: inline-block;width:25%;" onchange="test($(this).val())">
           <apex:selectOptions value="{!bdstyleslist}">
            </apex:selectOptions>
           </apex:selectList>
        </apex:outputpanel>
            </div>
             <div id="topbox" style="width:95%; height:auto; margin:0px auto; border:0px solid #ccc; padding:5px; margin-top:10px; padding-bottom:5px; border-radius:3px;   background-color:#F5F5F5;  box-shadow: #999 1px 3px 10px 0px; ">
          <table width="100%" border="0" style="margin:0px auto;">
            <tr>
              <td width="90%" >
              <apex:outputPanel layout="none"  id="searchpanel">
 
            <!-- This is our input text that we will use in a wildcard search against the names of the defined object. We refresh the results every time this field
            is clicked or a letter is entered (keyup) -->
            <apex:inputtext value="{!orderno}" id="searchValue" html-placeholder="Order-id / Email-id / First Name / Last Name / Company/Custom Barcode" style="width:100%; box-shadow: #F4F4F4 1px 4px 10px 0px; background:none; background-color: #FCFCFC;font-weight:bold;color: #000;border: 1px solid #e3e3e3;  text-indent:5px; padding-left:2px; height:40px; border-radius:3px; padding:0px; margin:0px; outline:none;" onkeydown="if(event.keyCode==13){this.blur();actionFunction();}">
            
                <apex:actionSupport event="onkeyup" action="{!search}" rerender="resultsPanel"/>
                <apex:actionSupport event="onclick" action="{!search}" rerender="resultsPanel"/>
            </apex:InputText>
 
            <!-- Once we perform the query on the object we will populate this list with the returned values. When a user selects a value we will hide this list
            and auto complete the selected value -->
            <apex:outputPanel id="resultsPanel" layout="none" >
                <apex:selectList id="srchlist" value="{!thisval}" size="{!height}" style="width:100%" rendered="{!showList}">
                    <apex:selectOptions value="{!results}"/>
                    <apex:actionSupport event="onchange" action="{!selectvalue}" rerender="resultsPanel,searchValue"/>
                </apex:selectList>
            </apex:outputPanel>
 
    </apex:outputPanel>

            
                
              </td>
             
              <td style=" text-indent:5px;">
             
              <apex:commandButton value="Search" id="Search" title="Search" styleClass="printbadge" action="{!getOrderDetails}" rerender="QuickRegistrationForm" oncomplete="showpackage('search-order');" status="AjaxLoader"/>
                           
              </td>
            </tr>
          </table>
        </div>
        <!--close of topbox--> 
              <!------------------------------------------> 
        <style>
        #search-table{ border-collapse:collapse;border-radius:3px;}
        #search-table th{border:none; text-align:left; text-indent:0px; padding:5px; font-size:14px; color:#fff;}
        
        #search-table .one  td{ padding:3px; text-indent:3px; background-color: #fff; font-size:14px; color:#000; border:1px #CFCFCF dotted; }
        /* #search-table .two  td{ padding:3px; text-indent:3px; background-color: #F6F6F6; font-size:14px; color:#000; border:1px #CFCFCF dotted; }*/
        </style>
        
        <!-------------Hidden Div code------------------->
           <style>
 /*     .one { background-color: white; }
.two { background-color: #E6F9E6; }*/
.selected td { background-color: #E0EFF7;font-size:14px; color:#000; border:1px #CFCFCF dotted;padding:3px; text-indent:3px;  } 
/*.selected_uncheck td { background-color: #ffffff;font-size:14px; color:#000; border:1px #CFCFCF dotted;padding:3px; text-indent:3px;  } */
      </style>
      <!-------------------checkbox highlight script-------------->
      <script>

 var elems = document.getElementsByTagName ( "input" );
    var len = elems.length;

    for ( var i = 0; i < len; i++ )
    {
        if ( elems[i].type == "checkbox" )
        {
            if(elems[i].checked == true)
            {
               var currentRow = elems[i].parentNode.parentNode;
               currentRow.setAttribute("class", "selected");
            }
        }
    }
      </script>
        <script>
        
      /* Highlight Row */
function highlight(id, currentClass, checkboxname)
{

 var checkbox_element = document.getElementsByName(checkboxname);
 var row_element = document.getElementById(id);


for (var i=0;i<checkbox_element.length;i++){
  if ( checkbox_element [i].checked ) {
   row_element.className = checkbox_element[i].checked ? 'selected' : currentClass;
  }
  }
}

function check_uncheck_all(){
     if ( document.getElementById('selector_check').checked === true )
{
    check_all();

    }
    else{
        uncheck_all();
    
        }    
}

/* Check All */

function check_all()
{
var num_checkboxes = document.forms[1].elements.length;


   for(i = 0; i < num_checkboxes; i++)
   {
   
      if(document.forms[1].elements[i].type == 'checkbox')
      {
        
         document.forms[1].elements[i].checked = true;
         
      }
   }
   
   highlight_all(num_checkboxes);
}
/* Uncheck All */

function uncheck_all()
{
var num_checkboxes = document.forms[1].elements.length;

   for(i = 0; i < num_checkboxes; i++)
   {
   
      if(document.forms[1].elements[i].type == 'checkbox')
      {
         document.forms[1].elements[i].checked = false;
      }
   }
   remove_highlight_for_all(num_checkboxes);
}

/* Highlight All Rows (this happens when 'check_all' is triggered */

function highlight_all(num)
{

   for(i = 1; i <= num; i++)
   {
      
      document.getElementById('tr' + i).className = 'selected';
      
   }
}



/* Remove highlight for all Rows (this happens when 'uncheck_all' is triggered */

function remove_highlight_for_all(num)
{
   for(i = 1; i <= num; i++)
   {
      var initial_class = (i % 2) ? 'one  td' : 'one td';
       document.getElementById('tr' + i).className = initial_class;
   }
}
<!-------------------end checkbox highlight script-------------->  
      </script>
      
      <div id="search-order" style="width:95%;display:none;  padding-bottom:5px; border:0px solid #ccc; padding:5px; margin-top:10px; padding-bottom:5px; border-radius:3px;   background-color:#F5F5F5;  box-shadow: #999 1px 3px 10px 0px;  margin:0px auto; margin-top:5px; height:145px;">
        <div style="height:144px; overflow:auto;border-radius:3px; ">
       
        <table width="100%" id="search-table" border="0"  style="border:1px #CFCFCF  solid;" >
  <tr bgcolor="#c2c2c2" style=" border:none;">
      <th width="2%" style="text-indent:2px;"><input id="selector_check" onClick="JavaScript: check_uncheck_all();" type="checkbox"/></th>
     <th>Ticket Name</th>
    <th width="15%">First Name</th>
    <th width="15%">Last Name</th>
    <th>Email</th>
      <th>Company</th>
      <th>Badge Label</th>
       <th >Order ID</th>
    <th width="10%">Ticket ID</th>
    <th width="10%">Custom Barcode</th>
  </tr>
  <apex:variable value="{!1}" var="rowNum"/>
  <apex:repeat value="{!twrap}" var="tk">
  <tr onclick="rowclick('{!tk.tckt.Id}','{!tk.tckt.tkt_profile__r.BLN_GN_User__c}')" id="tr{!rowNum}" class="one">
     <td><apex:inputcheckbox value="{!tk.selected}" onClick="JavaScript: highlight('tr{!rowNum}', 'one', this.name);"  >
         </apex:inputCheckbox>
     </td>
    <td>{!tk.tckt.Order_Item__r.Item__r.item_name__c}</td>
    <td>{!tk.tckt.tkt_profile__r.First_Name__c}</td>
    <td>{!tk.tckt.tkt_profile__r.Last_Name__c}</td>
    <td>{!tk.tckt.tkt_profile__r.Email__c}</td>
    <td>{!tk.tckt.tkt_profile__r.TKT_Company__c}</td>
    <td> 
   {!if(tk.tckt.Badge_ID__r.Badge_Label__c=='',tk.tckt.Badge_Label__c,tk.tckt.Badge_ID__r.Badge_Label__c)}
    </td>
    <td>{!tk.tckt.Order__r.Name}</td>
    <td>{!tk.tckt.name}</td>
    <td>{!tk.tckt.Custom_Barcode__c}</td>
  </tr>
  <apex:variable var="rowNum" value="{!rowNum + 1}"/>
  </apex:repeat>
</table>

        </div>
        
        
        </div><!--end of search email-->
        
        
        
        
        
        <!------------------End of Hidden Div Code-------->
        
        <!------------------------------------------> 
        
        <!--start of promocodebox-->

        <div id="promocodebox" style="width:95%; margin:0px auto; margin-top:5px;"> 
          
          <!--start of left div form-->
          <div style="width:42%; border:2px solid #C2C2C2; height:auto;  margin-top:10px; margin-right:20px; background-color:#efefef;background-image: url('{!URLFOR($Resource.QuickRegistration, "QuickRegistration/images/timer-component-bg.jpg")}'); box-shadow: #999 1px 3px 10px 0px; float:left;">
            <div style="width:100%; height:30px; background-color:#c2c2c2"></div>
           
            <table width="95%" id="formfield" border="0"  style="margin:0px auto; margin-top:0px; border-collapse:collapse;">
            <tr>
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Email</p></td>
              </tr>
              <tr>
                <td colspan="3">
                <apex:inputText value="{!ASUserEmail }"  id="email" onkeyup="this.value = this.value.toLowerCase();" onfocus="this.value = this.value.toLowerCase();this.oldvalue = this.value;" onchange="this.value = this.value.toLowerCase();showemailalert(this);this.oldvalue = this.value;">
               <!-- <apex:actionSupport event="onblur" action="{!processEmail}" reRender="QuickRegistrationForm" />-->
                </apex:inputtext>
                </td>
              </tr>
            <tr>
                <td width="42%" style="text-align:left; width:50%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">{!$ObjectType.User.Fields.FirstName.Label}</p></td>
                <td colspan="2" style="text-align:left"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">{!$ObjectType.User.Fields.LastName.Label}</p></td>
              </tr>
              <tr>
                <td width="42%" style="text-align:left; width:50%">
                <apex:inputText value="{!ASFirstName }"  id="firstname" />
                
                </td>
                <td colspan="2" style="text-align:right;">

                <apex:inputText value="{!ASLastName }" id="lastname" />
                </td>
              </tr>
              
              <tr>
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Company</p></td>
              </tr>
              <tr>
                <td colspan="3">
                <apex:inputText value="{!ASCompanyName }"  id="company" />
                </td>
              </tr>
              <tr>
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Title</p></td>
              </tr>
              <tr>
                <td colspan="3">
                 <apex:inputText value="{!ASTitle}"  id="title"/>
                </td>
              </tr>
              <tr>
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Phone Number</p></td>
              </tr>
              <tr>
                <td colspan="3">
                 <apex:inputText value="{!ASPhone }" onkeyup="javascript:keyUP(this,event);"  onblur="javascript:validatePhone(this);" id="phone"/>
                </td>
              </tr>
             
              <tr>
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Ticket Item</p></td>
              </tr>
              <tr>
             <td style="font-size:12px;">
                 <apex:selectList value="{!ticketitems }" size="1" style="width:205.5%;" id="selectitem" >
                 <apex:selectOptions value="{!myitems}"/>
                  <apex:actionSupport event="onchange" action="{!finditemdetail}" rerender="badgelabel,tmt,nonbadgeblock" oncomplete="countdown();update();if('{!nobadgelabel}'=='false'){document.getElementById('cbartr').style.display='';document.getElementById('cbartrfield').style.display='';} else {document.getElementById('cbartr').style.display='none';document.getElementById('cbartrfield').style.display='none';}"/>
                   </apex:selectList>
                              </td>
                
              </tr>
              <tr id="cbartr" >
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Custom Barcode</p></td>
              </tr>
              <tr id="cbartrfield">
                <td colspan="3">
                 <apex:inputText value="{!ASCustomBarcode }"  id="custmbarcodefield" />
                </td>
              </tr>
              <tr>
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">{!$ObjectType.Badge__c.Fields.Badge_Label__c.Label}</p></td>
              </tr>
              <tr>
                <td colspan="3">
                
                 <apex:inputText value="{!badgelabel}"  id="badgelabel" onkeyup="update()"/>
                 <apex:outputpanel id="nonbadgeblock">
                 <script>
                 try{
                nobadgelabel='{!nobadgelabel}';
                freeticket='{!freeticket}';
                if(freeticket=='true'){
                document.getElementById('pmethodtitle').style.display="none";
                document.getElementById('pmethodval').style.display="none";
                }
                else
                {
                  document.getElementById('pmethodtitle').style.display="";
                document.getElementById('pmethodval').style.display="";
                
                }
               
                if(nobadgelabel=='true')
                document.getElementById('{!$Component.badgelabel}').disabled = true;
                else
                document.getElementById('{!$Component.badgelabel}').disabled = false;
                      }catch(e){}
                 </script>
                 </apex:outputpanel>
                 <script>
                var tab="{!$CurrentPage.parameters.tab}";
                var tsize='{!twrap.size}';
                
                if((tab==''||tab=='attendee')&&(tsize==0||tsize=='')){
                document.getElementById('{!$Component.firstname}').disabled = true;
                document.getElementById('{!$Component.lastname}').disabled = true; 
                document.getElementById('{!$Component.email}').disabled = true;
                document.getElementById('{!$Component.company}').disabled = true;
                document.getElementById('{!$Component.title}').disabled = true;
                document.getElementById('{!$Component.phone}').disabled = true;
                document.getElementById('{!$Component.selectitem}').disabled = true;
                document.getElementById('{!$Component.badgelabel}').disabled = true;
                }
                else
                {
                
                document.getElementById('{!$Component.firstname}').disabled = false;
                document.getElementById('{!$Component.lastname}').disabled = false; 
                document.getElementById('{!$Component.email}').disabled = false;
                document.getElementById('{!$Component.company}').disabled = false;
                document.getElementById('{!$Component.title}').disabled = false;
                document.getElementById('{!$Component.phone}').disabled = false;
                document.getElementById('{!$Component.selectitem}').disabled = false;
                document.getElementById('{!$Component.badgelabel}').disabled = false;
               
                }
                
                </script>
                </td>
              </tr>
             
              <apex:outputpanel layout="none" rendered="{!IF($CurrentPage.parameters.tab==''||$CurrentPage.parameters.tab=='attendee'||searchFlag==true,false,true)}">
              
              <tr>
  <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Amount</p></td>
  </tr>
  <tr>
  <td  style="font-size:12px;">
 {!eventdetails.BLN_Country__r.Currency__r.Currency_Symbol__c}
  <apex:outputText value="{!ticketamount}" style="width:205.5%;" id="tmt" /></td>
  </tr>
  
               <tr id="pmethodtitle">
                <td colspan="3"  style="text-indent:.5%"><p style=" font-size:14px;font-weight:bold; font-family:cuprum;">Payment Method</p></td>
              </tr>
              <tr>
              <td style="font-size:12px;" id="pmethodval">
              <apex:selectList value="{!paymentmethod}" size="1" style="width:205.5%;" onchange="paymentmode(this.value);" id="ppmethd">
                 <apex:selectOptions value="{!paymentmethoditems}"/>
                  
                   </apex:selectList>
              </td>
              </tr>
              </apex:outputpanel>
             
              <tr>
              <td>
              <div id="checkpayment" style="width:205.5%; padding-bottom:30px; margin-top:20px;display:none">
            
            <div  style="width:90%; display:inline-block; padding:5px 5px 0px 5px; margin-top:0px;">
           
            <div  style="width:90%; border:1px solid #ffffff; display:inline-block; padding:5px ; margin-bottom:5px; background-color:#f8f8f7; float:left;">
            Enter Check Number:<apex:inputtext value="{!CheckNumber}"  onkeyup="Checknum(this)"/>
           </div></div>
            
            </div><!--close of payment--------> 
            
            
             <div id="payment" style="width:205.5%; padding-bottom:30px; margin-top:20px;display:none;">
            <div id="paymentwrapper" style="">
           <!---Start of titles----------->
           
           
            <table id="ordersummarytitles" border="0">
  <tr> 
    
        <td colspan="2" style="text-align:left;color:#6bbed2;">Payment Information</td>
        <!--<td width=""> <div id="stripe-line" style="margin-top:0px;"></div>close fo stripe-line</td>-->
        </tr>
</table>



 <!---close of titles----------->
            <div id="paymentcontentwrapper" style="width:100%; display:inline-block; padding:5px 5px 0px 5px; margin-top:0px;">
             <!---<apex:selectList value="{!SelectedCardType}" size="1" multiselect="false" style="width:98%; border: 1px solid #CCCCCC;border-collapse: collapse;-webkit-border-radius: 4px;border-radius: 4px 4px 4px 4px;-moz-border-radius: 4px;height: auto;padding-top: 3px;position: relative;color: #727373;height: 35px;">
                                <apex:selectOptions value="{!CreditCardType}"/>
                            </apex:selectList>---->
       <div>    
           
           
            <div id="paymentdetailscontent" style=" background-color:#CCCCCC; border:1px solid #ffffff; display:inline-block; padding:8px ; 
            margin-bottom:5px; background-color:#f8f8f7; float:left; height:168px;border-radius:8px; border:1px solid #eaeaea;margin-top:15px; padding:5px;">
            
           <div  id="cardholder" style="margin-left:0%; ">
            <div style="width:98%; margin:0px auto;">
            
            <ul style="list-style:none;display:inline;">
                <li style="list-style:none;display:inline; fon-size:32px; margin-bottom:15px;">Enter Details</li>
                <li style="list-style:none;display:inline;"><apex:image url="{!URLFOR($Resource.cardimages, 'mastercard_straight.png')}" width="50" height="31"/></li>
                <li style="list-style:none;display:inline;"><apex:image url="{!URLFOR($Resource.cardimages, 'visa_electron_straight.png')}" width="50" height="31"/></li>
                <li style="list-style:none;display:inline;"><apex:image url="{!URLFOR($Resource.cardimages, 'discover_straight.png')}" width="50" height="31"/></li>
                <li style="list-style:none;display:inline;"><apex:image url="{!URLFOR($Resource.cardimages, 'american_express_straight.png')}" width="50" height="31"/></li>
            </ul>
            
            </div>
             <div id="cardno" style="width:95%; margin:0px auto;">
             
             <apex:inputText value="{!CreditCardNumber}" id="CreditCardId" style="margin-top:10px;width:100%;border:1px solid #ccc;"/>
             
             </div><!--close of cardno-->
             
             <div style="width:100%; height:15px; "></div>
              <div style="width:34%; height:37px; float:left; padding-left:4%;">
              Expiration
              <apex:selectList value="{!SelectedMonth}" size="1" styleclass="selectoption" style=" width:70%; margin-top:2px; height:100%; background:none;border:1px solid #ccc;">
           <apex:selectOptions value="{!MonthsList}" />
                </apex:selectList>
             
             </div>
             
             <!-------------------------------------------->
              <div style="width:15%; height:37px; float:left;">
              <br />
              
                    <!--       <input type="date" placeholder="January (01)" style="width:99%;background:none; margin-left:3%;   font-size:9px; color:#999; border-radius:3px; margin:0px auto;height:38px; border:none"/>-->
                    <apex:selectList value="{!SelectedYear}" size="1" styleclass="selectoption" style="margin-top:2px; height:100%; background:none;border:none; margin-left:-20px;border:1px solid #ccc;">
            <apex:selectOptions value="{!YearsList}" />
                </apex:selectList>
               
              </div>
             <!-------------------------------------------->
             <!------------------------------------------->
             <div style="width:16%; height:39px; float:left; margin-left:15%;">
             CVV/CVC
                    <!--       <input type="date" placeholder="January (01)" style="width:99%;background:none; margin-left:3%;   font-size:9px; color:#999; border-radius:3px; margin:0px auto;height:38px; border:none"/>-->
                 <apex:inputText value="{!CVVNumber}" id="CVVNumberId" style="padding:-2px;padding-left:5px; margin-left:0px;width:100%;border:1px solid #ccc; height:35px;"/>
              </div>
             <!----------------------------------------------->
           </div><!--close of cardholder-->
         
            </div><!--close of paymentetailscontent-->
           
            </div><!--close of paymentcontentwrapper-->
            
            </div><!--close of paymentwrapper-->
            
            
            </div><!--close of payment-------->   
    
    
    
    </div>
    
    
    
    
    
    
    
    
    
    
                       
            
              </td>
              </tr>
              
              
              <tr>
                <td colspan="3" style=" padding:15px;">
                
                <apex:commandButton value="Print Badge" id="printbadge" title="Print" styleClass="printbadge" action="{!printupdate}" oncomplete="printPdf();" rerender="QuickRegistrationForm" Onclick="if(!move()) return false;" rendered="{!searchFlag}" status="AjaxLoader"/>
                <apex:outputpanel rendered="{!IF($CurrentPage.parameters.tab==''||$CurrentPage.parameters.tab=='attendee',false,true)}">
                <apex:commandButton value="Add and Print Badge" id="addprintbadge" title="AddPrint" styleClass="printbadge" action="{!order}" oncomplete="printPdf();" Onclick="if(!move()||!paymethodcheck()) return false;" rerender="QuickRegistrationForm"   rendered="{!!searchFlag}" status="AjaxLoader"/>
                <apex:commandButton value="Add" id="addprintbadgetp" title="AddPrint" styleClass="printbadge" action="{!ordertrustpaypal}" Onclick="if(!move()||!paymethodcheck()) return false;" status="AjaxLoader" style="display:none"/>
                </apex:outputpanel>
                <div style="display:none;width:100%; margin-left:1%;" id="TrustCommerce">
                    <table id="field box" class="fields" width="80%" border="0" style="margin:0px auto; border-collapse:collapse;">
                         <tr>
                            <td style=" padding:5px; text-align:left; font-size:13px; font-family:Arial, Helvetica, sans-serif;" valign="top">
                                <span style=" color:#F00">Note: </span><span style="color:#000; text-align:justify;">You will be taken to TrustCommerce page for payment. Please do not close or refresh the page until you are redirected to the success message after payment.</span>
                            </td>
                        </tr>
                    </table><!--close of field box-->
                </div>
                <div style="display:none;width:100%; margin-left:1%;" id="PayPal">
                    <table id="field box" class="fields" width="80%" border="0" style="margin:0px auto; border-collapse:collapse;">
                         <tr>
                            <td style=" padding:5px; text-align:left; font-size:13px; font-family:Arial, Helvetica, sans-serif;" valign="top">
                                <span style=" color:#F00">Note: </span><span style="color:#000; text-align:justify;">You will be taken to PayPal page for payment. Please do not close or refresh the page until you are redirected to the success message after payment.</span>
                            </td>
                        </tr>
                    </table><!--close of field box-->
                </div>
<!--<apex:commandButton value="Print All Using Zebra" id="printallbadge" title="Print All Using Zebra" styleClass="printbadge" action="{!getSelected}" oncomplete="multiprint();" rerender="QuickRegistrationForm"   rendered="{!searchFlag}"/>
<apex:commandButton value="Print All Using Avery 5392 Badge" id="printaverybadge" title="Print Avery 5392 Badge" styleClass="printbadge" action="{!printAvery}" rendered="{!searchFlag}"/>              
<apex:commandButton value="Merge Badge" id="mergebadge" title="Merge Badge" styleClass="printbadge" action="{!mergeBadge}" rerender="QuickRegistrationForm"   rendered="{!searchFlag}"/>-->
                </td>
              </tr>
            </table>
           
          </div>
          <!--end of left div form--> 
          
          <!--start of  right div iframe-->
           <div  style=" margin-top:50px; margin-right:50px; background-color:#eaeaea;background-image: url('{!URLFOR($Resource.QuickRegistration, "QuickRegistration/images/timer-component-bg.jpg")}'); border: #F6F6F6 10px solid; padding:10px; box-shadow: #999 1px 3px 10px 0px; float:right; text-align:center;">
             <div id="ifrmeSummary" >
             </div>
           
           </div>
          
          <!--end of left div form--> 
          
        </div>
        <!--end of promocodebox-->  
        <script>

//  window.onload=function(){
  //var badgeid="{!badgeid}";
  //if(badgeid!='')
  update();
  //Adding Logo
//$("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:firstname").focus();
$("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:firstname").keyup(update);
$("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:lastname").keyup(update);
$("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:company").keyup(update);
$("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:badgelabel").keyup(update);
$("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:title").keyup(update);

//} 




 function update(){ 

var fname= $("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:firstname").val();
var lname= $("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:lastname").val();
var company= $("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:company").val();
var badgelabel= $("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:badgelabel").val();
var name=fname+' '+lname;
var Atttitle = $("#QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:title").val();

var atttype='';
if(badgelabel.toUpperCase()=='EXHIBITOR')
{
atttype='<font style="valign:bottom;text-align:center;background-color:#008000;display:block;font-size:26px;color:#ffffff;font-face:Arial-BoldMT;">'+ badgelabel.toUpperCase()+'</font>';
}
if(badgelabel.toUpperCase()=='SPONSOR')
{
atttype='<font style="valign:bottom;text-align:center;background-color:#ff0000;display:block;font-size:26px;color:#ffffff;font-face:Arial-BoldMT;">'+ badgelabel.toUpperCase()+'</font>';
}
else
{
atttype='<font style="valign:bottom;text-align:center;background-color:black;display:block;font-size:26px;color:#ffffff;font-face:Arial-BoldMT;">'+ badgelabel.toUpperCase()+'</font>';
}


var abarcodeimage='';
var abarcode='';
abarcode="{!badgeid}";

if(abarcode!='')
{

$('#badgeqrid').val(abarcode);
}

//document.getElementById("ifrmeSummary").innerHTML=y;
//alert(name);
if(name !='' && name !=null && fname !='' && fname !=null && lname !='' && lname !=null )
$('#fullname').html(name);

if(company !='' && company !=null)
$('#company').html(company);

if(badgelabel !='' && badgelabel !=null)
$('#badgelabel').html(badgelabel);

if(Atttitle !='' && Atttitle !=null)
$('#designation').html(Atttitle);

try{
if(fname !='' && fname !=null)
$('#firstname').html(fname);
if(lname !='' && lname !=null)
$('#lastname').html(lname);
}catch(err){}


}

//var y='';
function printPdf() {
//alert(printContents);

 var style= $("[id$='bpop']").children(0).val();
 //alert(style);
 
// alert(style);

 var allpages = 'false';
//alert(style);
var tktid='';
tktid="{!presentticket}";
console.log(tktid);
var cerrormsg='{!cerrormsg}';
       if(cerrormsg!='')
         {
          //alert(cerrormsg);
          Alert.render(cerrormsg,'Alert!','ok');
          cerrormsg='';
          return;
         }
         var returnbadgeid='{!badgeid}';  
         var returnerror='{!error}';
         if(returnerror=='N - No Badge')
         {
          //alert('success');
           Alert.render('success' ,'Alert!','ok');
           window.location.href=window.location.href;
           return;
         }
          if(returnerror != '')
         {
           //alert(returnerror);
           Alert.render(returnerror ,'Alert!','ok');
           //window.location.href=window.location.href;
            paymentmode(document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:ppmethd}').value);
           return;
         }
         if(returnbadgeid=='')
         {
             //alert('Payment is not successfull');
            Alert.render('Payment is not successfull' ,'Alert!','ok');
            returnbadgeid='';
            try{
            paymentmode(document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:ppmethd}').value);
            }catch(e){}
            return;
         }     
            //Reset the page's HTML with div's HTML only

            //Print badge
            //window.open("{!$Label.SiteURL}/apex/BLN_BadgeTool_RenderPDF?style=372&allpages=false#a2L8A0000002KDTUA2");
            //just pass ticked id and Selected Badge Template Id to fallowing Page it Prints the badge In New Tab
           // window.open("{!$Label.SiteURL}/apex/BLN_BadgeTool_RenderPDF?style="+style+"&allpages="+allpages+"#"+tktid);
            
                //  setTimeout(function(){window.location.href=window.location.href;}, 2000);
            
         
         renderBadge(style,'true');  
           
    
  
}

function multiprint()
{
 var selsize='{!selectedTickets.size}';
 if(selsize==0){
  showpackage('search-order');
 //alert('Please select one record');
 Alert.render('Please select one record' ,'Alert!','ok');
 }
 else
 {

   <apex:repeat value="{!selectedTickets}" var="st"> 
            
var fname= "{!st.tkt_profile__r.First_Name__c}";
var lname= "{!st.tkt_profile__r.Last_Name__c}";
var company= "{!st.tkt_profile__r.TKT_Company__c}";
var name=fname+' '+lname;
var atttype='';
var badgelabel='';
var abarcode='';
var bdgsize="{!st.badges__r.size}";
if(bdgsize!=0){
<apex:repeat value="{!st.badges__r}" var="badge">
    abarcode='{!badge.Id}';
    badgelabel='{!badge.Badge_Label__c}';
    </apex:repeat>}
    else
    {
       abarcode='{!st.badge_id__c}';
    badgelabel='{!st.badge_id__r.Badge_Label__c}'; 
    }
if(badgelabel.toUpperCase()=='EXHIBITOR')
{
atttype='<font style="valign:bottom;text-align:center;background-color:#008000;display:block;font-size:26px;color:#ffffff;font-face:Arial-BoldMT;">'+ badgelabel.toUpperCase()+'</font>';
}
if(badgelabel.toUpperCase()=='SPONSOR')
{
atttype='<font style="valign:bottom;text-align:center;background-color:#ff0000;display:block;font-size:26px;color:#ffffff;font-face:Arial-BoldMT;">'+ badgelabel.toUpperCase()+'</font>';
}
else
{
atttype='<font style="valign:bottom;text-align:center;background-color:black;display:block;font-size:26px;color:#ffffff;font-face:Arial-BoldMT;">'+ badgelabel.toUpperCase()+'</font>';
}


var abarcodeimage='';

if(abarcode!='')
{
abarcodeimage='<img src="https://chart.googleapis.com/chart?chs=125x125&cht=qr&chl='+abarcode+'"/>';
}




 var evlogo='';
evlogo='<img src="/servlet/servlet.FileDownload?file={!eventdetails.Logo_URL__c }" style="width:100%;height:200px;padding-left:3px;padding-top:3px">';
y=y+'<html><head><script type="text/javascript"><\/script><style>@page{size:4.15in 3.5in;margin-top:-5px;margin-left:-5px;margin-bottom:-5px;margin-right:-5px;}.tablelabel {background:#25BEF5;padding:5px;}</style></head><body bgcolor="white"><table bgcolor="white" align="center" border="0" cellpadding="0" cellspacing="0" style="margin:0px;" width="100%" height="100%" ><tbody><tr><td><table bgcolor="white" align="center" border="0" cellpadding="0" cellspacing="0" style="width:100%; margin-top:10px;"><tbody><tr style="height:2.5cm;"><td height="100px" style="padding-Left:5px;" valign="top" width="100%"><span id="j_id0:j_id4">'+evlogo+'</span></td><td style="text-align:center; width:80%;padding-right:8px;font-size:15px" width="70%"><div style="text-align:center;width:125px; margin:0px auto; margin-top:-20px;position:relative; height:2.3cm;">'+abarcodeimage+'</div></td></tr></tbody></table></td></tr><tr style="height:1.0cm;"><td align="center" colspan="2" valign="top"><span><font style="font-size:24pt;" id="myname">'+name+'</font></span></td> </tr><tr><td align="center" colspan="2" style="padding:0;font-size:22pt;font-face:Calibri (Body);" valign="top" id="mycompany"><span id="mycompanyspan">'+company+'</span></td></tr><tr height="2cm"><td colspan="2" height="19" style="width:80%;font-size:18pt;font-face:Calibri (Body);Padding-Left:10px;Padding-Right:10px;text-align:right;" width="100%"><div style="width:100%;"><span id="j_id0:j_id31">'+atttype+'</span></div></td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table></body></html>';
var s='<html><head><script type="text/javascript"><\/script><style>@page{size:4.15in 3.5in;margin-top:-5px;margin-left:-5px;margin-bottom:-5px;margin-right:-5px;}.tablelabel {background:#25BEF5;padding:5px;}</style></head><body bgcolor="white"><table bgcolor="white" align="center" border="0" cellpadding="0" cellspacing="0" style="margin:0px;" width="100%" height="100%" ><tbody><tr><td><table bgcolor="white" align="center" border="0" cellpadding="0" cellspacing="0" style="width:100%; margin-top:10px;"><tbody><tr style="height:2.5cm;"><td height="100px" style="padding-Left:5px;" valign="top" width="100%"><span id="j_id0:j_id4">'+evlogo+'</span></td><td style="text-align:center; width:80%;padding-right:8px;font-size:15px" width="70%"><div style="text-align:center;width:125px; margin:0px auto; margin-top:-20px;position:relative; height:2.3cm;">'+abarcodeimage+'</div></td></tr></tbody></table></td></tr><tr style="height:1.0cm;"><td align="center" colspan="2" valign="top"><span><font style="font-size:24pt;" id="myname">'+name+'</font></span></td> </tr><tr><td align="center" colspan="2" style="padding:0;font-size:22pt;font-face:Calibri (Body);" valign="top" id="mycompany"><span id="mycompanyspan">'+company+'</span></td></tr><tr height="2cm"><td colspan="2" height="19" style="width:80%;font-size:18pt;font-face:Calibri (Body);Padding-Left:10px;Padding-Right:10px;text-align:right;" width="100%"><div style="width:100%;"><span id="j_id0:j_id31">'+atttype+'</span></div></td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table></body></html>';

  
  </apex:repeat>
 document.body.innerHTML = y;
             
               //Restore orignal HTML
           
         // setTimeout(function(){window.location.href=window.location.href;}, 2000);
           
            //Print Page
            window.print();
    }        
            }





//validation
function paymethodcheck()
{
 
var pm= document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:ppmethd}').value;

if(freeticket!='true')
if(pm== "" || pm== null)
{
//alert('Please Choose Payment Method');
Alert.render('Please Choose Payment Method' ,'Alert!','ok');
return false;
}

return true;
   
}

function move() {
var fn= document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:firstname}').value;
var ln= document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:lastname}').value;
document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:email}').value=document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:email}').value.trim();
var em= document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:email}').value;
var com= document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:company}').value;
var itemlist=document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:selectitem}').value;
var lb=document.getElementById('{!$Component.QuickRegistration:compo:commoncomponent:QuickRegistrationForm:badgelabel}').value;
fn=fn.trim();
ln=ln.trim();
em=em.trim();
com=com.trim();
if('{!searchFlag}'=='false'){
if(fn== "" || fn== null)
{
//blurAll();
//alert('Please Enter First Name');
 Alert.render('Please Enter First Name' ,'Alert','ok');
return false;
}

if(ln== "" || ln== null)
{
//blurAll();
//alert('Please Enter Last Name');
Alert.render('Please Enter Last Name' ,'Alert!','ok');
return false;
}

if(em== "" || em== null)
{
//alert('Please Enter Email');
Alert.render('Please Enter Email' ,'Alert!','ok');
//blurAll();
return false;
}
else
{
        //email validation
         var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

    if (!filter.test(em))
    {
        //alert('Please provide a valid email address');
        Alert.render('Please provide a valid email address' ,'Alert!','ok');
        return false;
    }
   
}

if(com== "" || com== null)
{
//alert('Please Enter Company');
Alert.render('Please Enter Company' ,'Alert!','ok');
//blurAll();
return false;
}
}
/*if((lb== "" || lb== null)&&nobadgelabel!='true')
{
//alert('Please Enter Badge Label');
Alert.render('Please Enter Badge Label' ,'Alert!','ok');
return false;
}*/

if(itemlist== "")
{
//alert('Please Enter Ticket Item');
Alert.render('Please Enter Ticket Item' ,'Alert!','ok');
//blurAll();
return false;
}

if('{!badgeid}'!=''){
Alert3.render();
return false;
}
 return true;

}


function blurAll()
{
 // $('#QuickRegistration\\:QuickRegistrationForm\\:firstname').blur();
 // $('#QuickRegistration\\:QuickRegistrationForm\\:lastname').blur();
  //$('#QuickRegistration\\:QuickRegistrationForm\\:email').blur();
  //$('#QuickRegistration\\:QuickRegistrationForm\\:company').blur();
  //$('#QuickRegistration\\:QuickRegistrationForm\\:selectitem').blur();
}



 
        function showpackage(show)
{
var listsize='{!ordtckt.size}';
if(listsize>0)
document.getElementById(show).style.display="block";

 var style= $("[id$='bpop']").children(0).val();
 renderBadge(style);


var tb='{!$CurrentPage.parameters.tab}';
if(listsize==0&&(tb==''||tb=='attendee'))
//alert("No tickets found");
 Alert.render('No tickets found' ,'Alert!','ok');

}



  function rowclick(ticketid,clientid)
  { 
    $("select[name='QuickRegistration\\:compo\\:commoncomponent\\:QuickRegistrationForm\\:selectitem']").val(ticketid+';'+clientid);
    finditemdetail();

  }
  

</script>

<apex:actionFunction name="finditemdetail" action="{!finditemdetail}" rerender="QuickRegistrationForm" oncomplete="showpackage('search-order');"/>
              
 <!--------start of payment hide and show------------->
            <style>
            #ordersummarytitles{
                border-collapse:collapse;
                font-size: 22px;
color: #5283cc;
margin-right: 10px;
letter-spacing: .5px;
font-family: Bebas Neue;
font-weight: normal;
                }
                
            #ordersummarytitles td{ padding:0px 5px ;}
            #ordersummarycontent table { border-collapse:collapse;}
            #ordersummarycontent table tr{ border-bottom:1px solid #ffffff;}
            #ordersummarycontent table td{ padding:5px; text-align:center; font-size:14px;} 
            #paymentwrapper{width:90%;  margin:0px auto; padding:10px; border: 4px solid #ffffff; box-shadow: 0 1px 3px 0 #b5b5b5;-moz-box-shadow: 0 1px 3px 0 #b5b5b5;-webkit-box-shadow: 0 1px 3px 0 #b5b5b5;}
            #ordersummarytitle{ font-size:16px; font-family:cuprum; background-color:#D7D7D7;} 
                   #stripe-line{
          
          overflow:hidden; 
          height:12px; 
          margin-top:5px; 
           }
 </style>
            
           
       <style>
#dialogoverlay{
    display:none;
    opacity:.8;
    position:fixed;
    top:0px; 
    left:0px;
    background-color: #484848;
    width:100%; 
    z-index:1000;
    height:100%;
    }



#dialogbox{ display:none; background-color:; position:fixed; padding:5px;
 width:40%; z-index:1000;  padding-top:30px;border-radius:3px; margin-left:30%;}

#close{ font-size:22px; font-weight:bold; color:#fff; text-decoration:none; float:right; margin-right:.2%; margin-top:-27px;}

</style>

<!----------------->

      <!----popup script------------------>
 <script type="text/javascript">
function CustomAlert(){
    this.render =function(dialog){
        var winW = window.innerWidth;
        var winH = window.innerHeight;
        var dialogoverlay =document.getElementById('dialogoverlay');
        var dialogbox = document.getElementById('dialogbox');
        dialogoverlay.style.display="block";
    
        dialogbox.style.top="120px";
        dialogbox.style.display="block";
    
    }
    
    this.ok = function(){
        document.getElementById('dialogbox').style.display ="none";
                document.getElementById('dialogoverlay').style.display ="none";
        
                
                return true;
        
        }
        
        
    this.Cancel = function(){
        document.getElementById('dialogbox').style.display ="none";
                document.getElementById('dialogoverlay').style.display ="none";
            
                
                return false;
        
        }
    
    }
    
    var Alert3 = new CustomAlert(); 
        

</script>

 <!--popup for print and add badge-->
 <div id="dialogoverlay"></div><!--close of dialogoverlay-->
<div id="dialogbox">
<a href="#" id="close" onclick="Alert3.Cancel()" >�</a>
<div class="grid-1" style=" width:98%;margin-left:1%; padding-right:0px;">
    <div class="title-grid">Reprint Badge</div>
    <div class="content-gird" >
   
  
    <p style="padding:5px; font-size:14px; text-align:center; font-weight:700; color: #67ABE0; ">The badge is already printed.Do you want to Reprint?</p>
    <div style="text-align:center;">
    <label style="vertical-align:top; color:#f00;">Reason:</label>
    <textarea class="medium" id="message" rows="3" style="width:55%; "></textarea>
    
    </div>
 
    <div style="padding:5px; padding-top:10px; text-align:center;">
    <button class="button-a blue" onclick="reprintupdate(document.getElementById('message').value);return false;" >Print</button>
                        &nbsp;&nbsp;
     <button class="button-a dark-blue" onclick="Alert3.Cancel();return false;" >Cancel</button>
    </div>

 

    
    </div><!--close of contentgrid-->
    </div><!--close of grid-1-->

</div><!--close of dialogbox-->
<!----close of print and add popup-->     
            
    <apex:actionfunction name="reprintupdate" action="{!printupdate}" oncomplete="printPdf();" rerender="QuickRegistrationForm" status="AjaxLoader">
    <apex:param name="Reason" value="" assignTo="{!reason}"/>
    </apex:actionfunction>       
            
                     
            </apex:form>   
             
             
             
  
             <script>
               function paymentmode(val) {
    if(val=='Check'){
   
        
        document.getElementById("payment").style.display="none";
        document.getElementById("checkpayment").style.display="";
        document.getElementById("QuickRegistration:compo:commoncomponent:QuickRegistrationForm:addprintbadge").style.display="";
        document.getElementById("QuickRegistration:compo:commoncomponent:QuickRegistrationForm:addprintbadgetp").style.display="none";
        document.getElementById('TrustCommerce').style.display="none";
        document.getElementById('PayPal').style.display="none";

        }else if(val=='Stripe'||val=='Authorize.Net'||val=='PayPalDirect'||val=='TrustCommerceDirect'){
       
            document.getElementById("checkpayment").style.display="none";
        document.getElementById("payment").style.display="";
    }
    else if(val=='TrustCommerce'||val=='PayPal')
    {
     document.getElementById("checkpayment").style.display="none";
        document.getElementById("payment").style.display="none";
        document.getElementById("QuickRegistration:compo:commoncomponent:QuickRegistrationForm:addprintbadge").style.display="none";
        document.getElementById("QuickRegistration:compo:commoncomponent:QuickRegistrationForm:addprintbadgetp").style.display="";
        document.getElementById('TrustCommerce').style.display="none";
        document.getElementById('PayPal').style.display="none";
        if(val=='TrustCommerce')
        document.getElementById('TrustCommerce').style.display="";
        if(val=='PayPal')
        document.getElementById('PayPal').style.display="";
    
    }
    else
    {
         document.getElementById("checkpayment").style.display="none";
        document.getElementById("payment").style.display="none";
        document.getElementById('TrustCommerce').style.display="none";
        document.getElementById('PayPal').style.display="none";
    }
};
              
              </script>
             
             
             <script>
                    var oldemail='';
                    function showemailalert(textbox)
                    {
              if(textbox.value!=textbox.oldvalue)
              {
                    oldemail=textbox.oldvalue;
                  /********begin remoting******/
                      Visualforce.remoting.Manager.invokeAction(
            '{!$RemoteAction.BLN_Quick_Registration_Con.checkUser}',
            textbox.value,
           function(result, event){
          
           if(result=='Exist')
           {
                          customConfirm1('1',textbox);
                      }
                      else
                      {
                          if(oldemail!='')
                 {
                              var alertmsg='New User '+textbox.value+' will be created.Do you want to copy all the data from '+oldemail+'?';
                              var conf=customConfirm2('2',alertmsg); 
                          }
                      }
                  },
                 {escape: true});    
                 /*******end remoting******/
              }
            }
                 
        var textbox='';
        function customConfirm1(clkbtn,textbox1)
        {
            Alertconfirm.render('If you change the email address, the complete user information will be replaced with the new user details.' , 'Confirmation',clkbtn,'Yes','No','Alertconfirm');
            textbox=textbox1;
        }
        function customConfirm2(clkbtn,alertmsg)
        {
            Alertconfirm.render(alertmsg , 'Confirmation',clkbtn,'Yes','No','Alertconfirm');
        }
        function callback(clkbtn , okbtnn)
        {
            if(clkbtn =='1')
             {
                  /******** begin remoting*********/
                  Visualforce.remoting.Manager.invokeAction(
                 '{!$RemoteAction.BLN_Quick_Registration_Con.getGnuser}',
                   textbox.value,
                    function(gnuser, event){
                    console.log(gnuser);
                    
                    $("[id$='firstname']").val(gnuser.First_Name__c);
                    $("[id$='lastname']").val(gnuser.Last_Name__c);
                    $("[id$='phone']").val(gnuser.Mobile__c);
                    
                        }, 
                     {escape: true});   
                   /******** end remoting*********/                                    
             }
             if(clkbtn =='2')
             {                    
             }                                
        }
        function callbackcancel(clkbtn,cnclbtnn)
        {
            if(clkbtn =='1')
           {
                 $("[id$='Email']").val(oldemail);
           }
           if(clkbtn =='2')
           {
                $("[id$='firstname']").val('');
                $("[id$='lastname']").val('');
                $("[id$='phone']").val('');         
            }
         }
       </script>     
           
      
                   <div class="clear"></div>
                   </div>
                   
               </c:myComponent>
               <script type="text/javascript">
              
    // set minutes
    var mins = 5;
    
    // calculate the seconds (dont change this! unless time progresses at a different speed for you...)
    var secs = mins * 60;
    function countdown() {
        setTimeout('Decrement()',1000);
    }
    function Decrement(){
        
            if(secs==0){
                //alert("You have crossed the Maximum time.Page will be refreshed now.Please complete registration within 5 minutes");
                Alert.render('You have crossed the Maximum time.Page will be refreshed now.Please complete registration within 5 minutes' ,'Alert!','ok');
                window.location.href=window.location.href;
            }else{
                secs--;
                setTimeout('Decrement()',1000);
            }
       
    }
    
    </script>
 
    <script>
    $(document).ready(function(){
    var style= $("[id$='bpop']").children(0).val();
 //alert(style);
 if(style !=null && style !=undefined && style !='' )
    test(style);
    
    });
    
    </script>
    <script>
    //alert("{!badgeid}");
    </script>
    
    
    
    
</apex:page>